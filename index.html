<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Astroneer - Takaro Integration</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #e0e0e0;
            line-height: 1.6;
            padding: 20px;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            background: rgba(30, 30, 40, 0.95);
            padding: 40px;
            border-radius: 15px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
        }

        h1 {
            color: #a78bfa;
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
        }

        h2 {
            color: #c4b5fd;
            margin-top: 30px;
            margin-bottom: 15px;
            font-size: 1.8em;
        }

        h3 {
            color: #ddd6fe;
            margin-top: 20px;
            margin-bottom: 10px;
        }

        .subtitle {
            color: #9ca3af;
            font-size: 1.1em;
            margin-bottom: 30px;
        }

        .warning {
            background: rgba(239, 68, 68, 0.1);
            border-left: 4px solid #ef4444;
            padding: 15px;
            margin: 20px 0;
            border-radius: 5px;
        }

        .info {
            background: rgba(59, 130, 246, 0.1);
            border-left: 4px solid #3b82f6;
            padding: 15px;
            margin: 20px 0;
            border-radius: 5px;
        }

        .download-btn {
            display: inline-block;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 15px 30px;
            text-decoration: none;
            border-radius: 8px;
            font-size: 1.2em;
            font-weight: bold;
            margin: 20px 0;
            transition: transform 0.2s, box-shadow 0.2s;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
        }

        .download-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.6);
        }

        .features {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }

        .feature {
            background: rgba(255, 255, 255, 0.05);
            padding: 20px;
            border-radius: 10px;
            border: 1px solid rgba(167, 139, 250, 0.2);
        }

        .feature h3 {
            margin-top: 0;
            color: #a78bfa;
        }

        code {
            background: rgba(0, 0, 0, 0.3);
            padding: 2px 6px;
            border-radius: 3px;
            font-family: 'Courier New', monospace;
            color: #fbbf24;
        }

        pre {
            background: rgba(0, 0, 0, 0.3);
            padding: 15px;
            border-radius: 5px;
            overflow-x: auto;
            margin: 15px 0;
        }

        pre code {
            background: none;
            padding: 0;
            color: #e0e0e0;
        }

        ol, ul {
            margin-left: 25px;
            margin-bottom: 15px;
        }

        li {
            margin-bottom: 10px;
        }

        a {
            color: #a78bfa;
            text-decoration: none;
        }

        a:hover {
            color: #c4b5fd;
            text-decoration: underline;
        }

        .step-number {
            display: inline-block;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            text-align: center;
            line-height: 30px;
            font-weight: bold;
            margin-right: 10px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üöÄ Astroneer - Takaro Integration</h1>
        <p class="subtitle">Connect your Astroneer dedicated server to Takaro using native RCON. No mods required!</p>

        <div class="info">
            <strong>‚ÑπÔ∏è About Takaro</strong><br>
            Takaro is a comprehensive game server management platform that provides powerful admin tools, moderation systems, player analytics, and automation features for game servers.
        </div>

        <div class="warning">
            <strong>‚ö†Ô∏è IMPORTANT</strong><br>
            Takaro is currently invite-only. To get access:
            <ol>
                <li>Go to <a href="https://takaro.io" target="_blank">Takaro.io</a> and complete the interest survey</li>
                <li>Join the <a href="https://discord.gg/takaro" target="_blank">Takaro Discord server</a></li>
                <li>Request an invite from the team</li>
            </ol>
        </div>

        <div class="info">
            <strong>üéâ v1.11.8 - STABLE RELEASE!</strong><br>
            All features working: Player events, Discord notifications, server shutdown, and full RCON command support.
        </div>

        <h2>üì• Download</h2>
        <a href="https://github.com/mad-001/takaro-astroneer-bridge/releases/tag/v1.11.8" class="download-btn">
            üåü Download Latest Version (v1.11.8) üåü
        </a>
        <p><small>Released: December 17, 2025 | <a href="https://github.com/mad-001/takaro-astroneer-bridge/releases">View All Releases</a></small></p>

        <h2>üÜï What's New in v1.11.8</h2>
        <div class="info">
            <h3>Stable Release - All Features Working</h3>
            <p><strong>This release adds debug logging and confirms all features are operational:</strong></p>

            <ul>
                <li>‚úÖ Real-time player connect/disconnect events</li>
                <li>‚úÖ Discord notifications (< 1 second latency)</li>
                <li>‚úÖ Server shutdown command working correctly</li>
                <li>‚úÖ Full RCON command support</li>
                <li>‚úÖ Debug logging for troubleshooting command issues</li>
            </ul>

            <p><strong>Recommended for all users.</strong> This is the most stable version with all features tested and working.</p>
        </div>

        <h2>üìú Previous Updates</h2>
        <details>
            <summary><strong>v1.11.7 - Event Processing Fix</strong></summary>
            <div class="info" style="margin-top: 15px;">
                <h3>Fixed Event Processing Hang</h3>
                <p>Bridge now responds immediately to <code>getPlayerLocation</code> requests, allowing events to be created in the database.</p>
            </div>
        </details>
        <div class="info">
            <h3>Critical Fix - Event Processing No Longer Hangs</h3>
            <p><strong>The Problem:</strong> Events were being sent correctly, but Takaro's request for <code>getPlayerLocation</code> was being queued instead of answered immediately. This caused event processing to hang indefinitely, preventing events from being created in the database.</p>

            <p><strong>The Fix:</strong></p>
            <ul>
                <li>Bridge now responds immediately to <code>getPlayerLocation</code> requests</li>
                <li>Returns dummy location <code>{ x: 0, y: 0, z: 0 }</code> to allow event processing to complete</li>
                <li>Events are created in Takaro database within 1 second</li>
                <li>Discord notifications and all hooks trigger properly</li>
            </ul>

            <p><strong>Result:</strong> Full real-time player event support is now working!</p>
        </div>

        <h2>üìú Previous Updates</h2>
        <details>
            <summary><strong>v1.11.5 - Event Format Fix</strong></summary>
            <div class="info" style="margin-top: 15px;">
                <h3>Restored Working Event Format</h3>
                <p>Events now use <code>type: 'gameEvent'</code> as expected by Takaro instead of incorrect <code>type: 'request'</code> format.</p>
            </div>
        </details>
        <div class="info">
            <h3>Critical Fix - Event Format Restored</h3>
            <p><strong>The Problem:</strong> Events were being sent with the wrong format (<code>type: 'request'</code>) instead of the correct <code>type: 'gameEvent'</code> format. This caused Takaro to ignore all events, breaking Discord notifications and event-triggered hooks.</p>

            <p><strong>The Fix:</strong></p>
            <ul>
                <li>Restored v1.11.1's working event format</li>
                <li>Events now use <code>type: 'gameEvent'</code> as expected by Takaro</li>
                <li>Discord notifications work again</li>
                <li>All hooks and modules triggered by player events now function correctly</li>
            </ul>

            <p><strong>Combined with v1.11.4:</strong> Shutdown commands work reliably AND events trigger properly!</p>
        </div>

        <h2>üìú Previous Updates</h2>
        <details>
            <summary><strong>v1.11.4 - Shutdown Command Fix</strong></summary>
            <div class="info" style="margin-top: 15px;">
                <h3>Fixed Shutdown Breaking Bridge</h3>
                <p>Server shutdown commands no longer break the bridge. Shutdown executes asynchronously and RCON auto-reconnects.</p>
            </div>
        </details>
        <details>
            <summary><strong>v1.11.0-v1.11.3 - Click to expand</strong></summary>
        <div class="info">
            <h3>Critical Bug Fix - Shutdown Command No Longer Breaks Bridge</h3>
            <p><strong>The Problem:</strong> In v1.11.2-v1.11.3, server shutdown commands would wait for RCON response, but the server would disconnect before responding. This caused errors that broke all subsequent bridge operations including player events.</p>

            <p><strong>The Fix:</strong></p>
            <ul>
                <li>Shutdown commands now respond immediately to Takaro</li>
                <li>Server shutdown executes asynchronously without blocking</li>
                <li>RCON auto-reconnects when server comes back online</li>
                <li>Player connect/disconnect events work reliably again</li>
            </ul>

            <p><strong>Recommendation:</strong> If you're on v1.11.2 or v1.11.3, update immediately to restore full functionality.</p>
        </div>

        <h2>üìú Previous Updates</h2>
        <details>
            <summary><strong>v1.11.0-v1.11.3 - Click to expand</strong></summary>
            <div class="info" style="margin-top: 15px;">
                <h3>v1.11.0 - Player Events Fixed</h3>
                <p>Player connect/disconnect events now work instantly via WebSocket! Critical bugs fixed for real-time event delivery.</p>
            </div>
        </details>

        <h2>üîß Technical Details (v1.11.0)</h2>
        <div class="info">
            <h3>Critical Bug Fixes - Events Now Work Instantly!</h3>
            <p><strong>The Problem:</strong> Events were being sent but silently dropped by Takaro due to two critical bugs:</p>

            <p><strong>Bug Fix #1 - Null Values in Optional Fields:</strong></p>
            <p>The bridge was sending <code>null</code> for optional fields like <code>epicOnlineServicesId</code> and <code>ip</code>. Takaro's strict validation rejects null values - optional fields must be completely omitted instead.</p>

            <p><strong>Bug Fix #2 - getPlayerLocation Hanging:</strong></p>
            <p>During event processing, Takaro requests player location. The bridge was queuing this request without responding, causing event processing to hang indefinitely.</p>

            <p><strong>The Result:</strong></p>
            <ol>
                <li>‚úÖ Events delivered via WebSocket <code>gameEvent</code> messages (no module needed!)</li>
                <li>‚úÖ Instant event delivery (< 1 second latency)</li>
                <li>‚úÖ 100% reliability - events always created</li>
                <li>‚úÖ Hooks and Discord notifications work immediately</li>
                <li>‚úÖ Simpler architecture - just the bridge, no Takaro module required</li>
            </ol>

        </div>

        <h2>‚ö° Quick Start</h2>
        <ol>
            <li><strong><span class="step-number">1</span>Install Node.js</strong><br>
                <strong>Easy way:</strong> Open PowerShell as Administrator and run:
                <pre><code>winget install OpenJS.NodeJS.LTS</code></pre>
                <strong>Or download:</strong> <a href="https://nodejs.org/dist/v20.11.0/node-v20.11.0-x64.msi" target="_blank">Direct Download (Windows x64)</a><br>
                <small>After installing, restart your computer</small>
            </li>
            <li><strong><span class="step-number">2</span>Download & Extract</strong><br>
                Extract the zip file anywhere on your PC
            </li>
            <li><strong><span class="step-number">3</span>Enable RCON on Astroneer</strong><br>
                Open <code>\astroneer\Astro\Saved\Config\WindowsServer\AstroServerSettings.ini</code> in Notepad<br>
                <strong>ADD these two lines</strong> (they won't be there by default):
                <pre><code>ConsolePort=8778
ConsolePassword=your-password-here</code></pre>
                <small>üìù Use any port number you want - just remember it for Step 4!</small><br>
                Save and restart your Astroneer server
            </li>
            <li><strong><span class="step-number">4</span>Configure Bridge</strong><br>
                Open <code>TakaroConfig.txt</code> in Notepad and edit these settings:
                <pre><code>IDENTITY_TOKEN=your-server-name
REGISTRATION_TOKEN=get-from-takaro-dashboard
HTTP_PORT=3535
RCON_HOST=127.0.0.1
RCON_PORT=8778
RCON_PASSWORD=same-password-as-step-3</code></pre>
                <small>‚ö†Ô∏è RCON_PORT must match ConsolePort from Step 3!</small><br>
                <small>üí° If bridge is on same PC as Astroneer, keep RCON_HOST as 127.0.0.1</small>
            </li>
            <li><strong><span class="step-number">5</span>Start the Bridge</strong><br>
                Double-click <code>start.bat</code><br>
                <small>You should see: ‚úì Connected to Takaro WebSocket & ‚úì Connected to Astroneer RCON</small>
            </li>
        </ol>

        <h2>‚ú® Features</h2>
        <div class="features">
            <div class="feature">
                <h3>üîå RCON Integration</h3>
                <p>Uses Astroneer's native RCON protocol - no game modifications needed!</p>
            </div>
            <div class="feature">
                <h3>üë• Player Events</h3>
                <p>Real-time player join/leave notifications forwarded to Takaro</p>
            </div>
            <div class="feature">
                <h3>‚öôÔ∏è Remote Commands</h3>
                <p>Execute server commands through Takaro (kick, player list, etc.)</p>
            </div>
            <div class="feature">
                <h3>üñ•Ô∏è Interactive Console</h3>
                <p>NEW! Direct RCON console for manual server administration and testing</p>
            </div>
            <div class="feature">
                <h3>üìä Monitoring</h3>
                <p>Built-in health endpoint with connection status and metrics</p>
            </div>
        </div>

        <h2>üîß Configuration</h2>
        <p>The bridge uses a simple <code>TakaroConfig.txt</code> file for configuration. Get your tokens from the <a href="https://dashboard.takaro.io/gameservers/create" target="_blank">Takaro Dashboard</a>.</p>

        <h2>üñ•Ô∏è RCON Console (NEW!)</h2>
        <p>The bridge now includes an interactive RCON console for direct server administration!</p>
        <p><strong>To use:</strong> Double-click <code>rcon-console.bat</code> to open an interactive terminal.</p>
        <p><strong>Example commands:</strong> (Note: Commands are typed WITHOUT the "DS" prefix - it's added automatically)</p>
        <pre><code>RCON> help                    # Show all available commands
RCON> ListPlayers             # List all players
RCON> ServerStatistics        # Get detailed server stats
RCON> SaveGame MyBackup       # Save the game
RCON> exit                    # Close console</code></pre>
        <p>The console connects directly to your Astroneer server via RCON, allowing you to:</p>
        <ul>
            <li>Manage players (kick, change roles)</li>
            <li>Control save games (save, load, delete)</li>
            <li>Configure server settings (password, whitelist, timeouts)</li>
            <li>View server statistics in real-time</li>
            <li>Test and debug RCON commands</li>
        </ul>

        <h2>‚ùì Troubleshooting</h2>
        <ul>
            <li><strong>"Publisher cannot be verified" security warning</strong> - This is normal for downloaded files. Click <strong>"More info"</strong> then <strong>"Run anyway"</strong>. OR: Right-click start.bat ‚Üí Properties ‚Üí Check "Unblock" at the bottom ‚Üí Apply ‚Üí OK</li>
            <li><strong>"node is not recognized"</strong> - Install Node.js and restart your computer</li>
            <li><strong>"RCON connection failed"</strong> - Check that RCON_PORT and RCON_PASSWORD in TakaroConfig.txt match ConsolePort and ConsolePassword in AstroServerSettings.ini. Make sure Astroneer server is running.</li>
            <li><strong>"Takaro connection failed"</strong> - Verify your token is correct at <a href="https://dashboard.takaro.io/gameservers/create" target="_blank">dashboard.takaro.io/gameservers/create</a></li>
        </ul>

        <h2>üîó Resources</h2>
        <ul>
            <li><a href="https://github.com/mad-001/takaro-astroneer-bridge/releases" target="_blank">üì¶ All Releases</a></li>
            <li><a href="https://github.com/mad-001/takaro-astroneer-bridge/blob/master/References.md" target="_blank">üìö References & Documentation</a> - API docs, working examples, and technical insights</li>
            <li><a href="https://api.takaro.io/api.html" target="_blank">üîß Takaro API Reference</a></li>
            <li><a href="https://docs.takaro.io/" target="_blank">üìñ Takaro Documentation</a></li>
            <li><a href="https://takaro.io" target="_blank">üåê Takaro Platform</a></li>
            <li><a href="https://discord.gg/takaro" target="_blank">üí¨ Discord Community</a></li>
        </ul>

        <hr style="margin: 40px 0; border: none; border-top: 1px solid rgba(167, 139, 250, 0.2);">
        <p style="text-align: center; color: #9ca3af;">
            Made with ‚ù§Ô∏è for the Astroneer community<br>
            <small>¬© 2025 | <a href="https://github.com/mad-001" target="_blank">GitHub</a></small>
        </p>
    </div>
</body>
</html>
